<div class="rounded-2xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03] overflow-hidden">

    <!-- Header -->
    <div class="flex items-center justify-between px-6 py-4 border-b border-gray-100 dark:border-gray-800">
        <div>
            <h3 class="text-base font-bold text-gray-800 dark:text-white/90">Low Stock</h3>
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-0.5">Products needing restock</p>
        </div>
        <a routerLink="/store/app/products" [queryParams]="{ stockFilter: 'low-stock' }"
           class="inline-flex items-center gap-1.5 px-3 py-2 text-xs font-semibold text-rose-500 dark:text-rose-400 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 rounded-xl transition-all duration-200">
            View all
            <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
            </svg>
        </a>
    </div>

    <!-- SKELETON -->
    <div *ngIf="isLoading" class="divide-y divide-gray-50 dark:divide-gray-800">
        <div *ngFor="let i of [1,2,3]" class="flex items-center gap-3 px-6 py-3.5">
            <div class="w-10 h-10 rounded-xl bg-gray-200 dark:bg-gray-700 animate-pulse flex-shrink-0"></div>
            <div class="flex-1 space-y-2">
                <div class="h-4 w-36 rounded-lg bg-gray-200 dark:bg-gray-700 animate-pulse"></div>
                <div class="h-3 w-20 rounded-lg bg-gray-200 dark:bg-gray-700 animate-pulse"></div>
            </div>
            <div class="h-6 w-12 rounded-lg bg-gray-200 dark:bg-gray-700 animate-pulse"></div>
        </div>
    </div>

    <!-- ITEMS -->
    <div *ngIf="!isLoading && items && items.items.length > 0" class="divide-y divide-gray-50 dark:divide-gray-800">
        <div *ngFor="let product of items.items"
             class="flex items-center gap-3 px-6 py-3.5 hover:bg-gray-50 dark:hover:bg-white/[0.02] transition-colors">

            <!-- Image -->
            <div class="w-10 h-10 rounded-xl overflow-hidden flex-shrink-0 bg-gray-100 dark:bg-gray-800">
                <img *ngIf="product.images && product.images[0]"
                     [src]="product.images[0]" [alt]="product.name"
                     class="w-full h-full object-cover"/>
                <div *ngIf="!product.images || !product.images[0]"
                     class="w-full h-full flex items-center justify-center bg-gradient-to-br from-rose-400 to-rose-600">
                    <span class="text-xs font-bold text-white">
                        {{ getInitials(product.name) }}
                    </span>
                </div>
            </div>

            <!-- Name -->
            <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-gray-800 dark:text-white/90 truncate cursor-pointer hover:text-brand-600 dark:hover:text-brand-400 transition-colors"
                   (click)="router.navigate(['/store/app/products', product._id])"
                >
                    {{ product.name }}
                </p>
                <p class="text-xs text-gray-400 dark:text-gray-500 mt-0.5">
                    {{ product.stockReal === 0 ? 'Out of stock' : product.stockReal + ' units left' }}
                </p>
            </div>

            <!-- Stock badge -->
            <span class="inline-flex items-center justify-center px-2.5 py-1 rounded-lg text-xs font-bold flex-shrink-0"
                  [ngClass]="getStockColor(product.stockReal)">
                {{ product.stockReal }}
            </span>
        </div>

        <!-- More indicator -->
        <div *ngIf="items.total > items.items.length"
             class="px-6 py-3 flex items-center justify-between bg-gray-50/50 dark:bg-white/[0.01]">
            <span class="text-xs text-gray-400 dark:text-gray-500">
                Showing <span class="font-semibold text-gray-600 dark:text-gray-300">{{ items.items.length }}</span> of
                <span class="font-semibold text-gray-600 dark:text-gray-300">{{ items.total }}</span> products
            </span>
            <a routerLink="/v1/boutique/products" [queryParams]="{ lowStock: true }"
               class="text-xs font-semibold text-rose-500 hover:text-rose-600 transition-colors">
                See all â†’
            </a>
        </div>
    </div>

    <!-- EMPTY -->
    <div *ngIf="!isLoading && (!items || items.items.length === 0)"
         class="flex flex-col items-center justify-center py-10 text-center px-6">
        <div class="w-12 h-12 rounded-full bg-emerald-50 dark:bg-emerald-900/20 flex items-center justify-center mb-3">
            <svg class="w-6 h-6 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
            </svg>
        </div>
        <p class="text-sm font-semibold text-gray-600 dark:text-gray-300">All stocks are healthy</p>
        <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">No products need restocking</p>
    </div>

</div>